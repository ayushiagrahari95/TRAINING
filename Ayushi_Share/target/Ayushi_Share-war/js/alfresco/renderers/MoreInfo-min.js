define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_OnDijitClickMixin","alfresco/renderers/_XhrActionsMixin","alfresco/core/ObjectProcessingMixin","alfresco/core/ObjectTypeUtils","dojo/text!./templates/MoreInfo.html","alfresco/core/Core","alfresco/documentlibrary/views/layouts/Popup","dojo/_base/lang","dojo/dom-class","dojo/_base/event"],function(p,b,m,i,e,o,j,r,h,d,s,f,n){return p([b,m,i,e,o,h],{cssRequirements:[{cssFile:"./css/MoreInfo.css"}],i18nRequirements:[{i18nFile:"./i18n/MoreInfo.properties"}],templateString:r,currentItem:null,moreInfoDialog:null,xhrRequired:false,darkIcon:false,altText:"moreinfo.altTextWithContext.label",propertyToRender:"displayName",postMixInProperties:function k(){if(this.altText==null){this.altText=""}else{if(this.propertyToRender!=null&&this.currentItem!=null&&this.currentItem[this.propertyToRender]){this.altText=this.message(this.altText,{0:(this.currentItem!=null?this.currentItem[this.propertyToRender]:"")})}else{this.altText=this.message(this.altText)}}},postCreate:function l(){if(this.darkIcon===true){f.add(this.domNode,"darkIcon")}},onMoreInfo:function a(t){n.stop(t);if(this.moreInfoDialog==null){if(this.xhrRequired===true){this.getXhrData()}else{this.createMoreInfoDialog()}}else{this.moreInfoDialog.show()}},createMoreInfoDialog:function g(){var u="";if(j.isObject(this.currentItem)&&s.exists("displayName",this.currentItem)){u=s.getObject("displayName",false,this.currentItem)}var t=s.clone(this.widgets);this.processObject(["processInstanceTokens"],t);this.moreInfoDialog=new d({title:u,currentItem:this.currentItem,widgetsContent:t});this.moreInfoDialog.show()},clearLoadingItem:function c(){},addXhrItems:function q(){this.createMoreInfoDialog()},allowedActionsString:'["document-download","document-view-content","document-view-details","folder-view-details","document-edit-metadata","document-inline-edit","document-manage-granular-permissions","document-manage-repo-permissions","document-view-original","document-view-working-copy","folder-manage-rules","document-view-googlemaps","document-view-in-source-repository","document-view-in-cloud","document-delete","document-edit-offline","folder-download","document-copy-to","document-move-to","document-locate","document-assign-workflow","document-cancel-editing"]',widgets:[{name:"alfresco/documentlibrary/views/layouts/Table",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/Thumbnail",config:{renditionName:"imgpreview"}}]}},{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/Actions",config:{filterActions:true,allowedActionsString:"{allowedActionsString}"}}]}}]}},{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/InlineEditProperty",config:{propertyToRender:"node.properties.cm:name",postParam:"prop_cm_name",renderSize:"large",publishTopic:"ALF_CRUD_CREATE",publishPayloadType:"PROCESS",publishPayloadModifiers:["processCurrentItemTokens"],publishPayloadItemMixin:false,publishPayload:{url:"api/node/{jsNode.nodeRef.uri}/formprocessor",noRefresh:false,successMessage:"moreInfo.inlineEdit.update.success"},renderFilter:[{property:"node.permissions.user.Write",values:[true]}],requirementConfig:{initialValue:true},validationConfig:[{validation:"regex",regex:'(["*\\><?/:|]+)|([.]?[.]+$)',errorMessage:"moreinfo.invalid.name",invertRule:true}]}},{name:"alfresco/renderers/Property",config:{propertyToRender:"node.properties.cm:name",renderFilter:[{property:"node.permissions.user.Write",values:[false]}]}},{name:"alfresco/renderers/InlineEditProperty",config:{propertyToRender:"node.properties.cm:title",postParam:"prop_cm_title",renderSize:"small",warnIfNotAvailable:true,warnIfNoteAvailableMessage:"no.title.message",renderedValuePrefix:"(",renderedValueSuffix:")",renderFilterMethod:"ALL",renderFilter:[{property:"node.properties.cm:title",values:[""],negate:true},{property:"node.permissions.user.Write",values:[true]}],publishTopic:"ALF_CRUD_CREATE",publishPayloadType:"PROCESS",publishPayloadModifiers:["processCurrentItemTokens"],publishPayloadItemMixin:false,publishPayload:{url:"api/node/{jsNode.nodeRef.uri}/formprocessor",noRefresh:false,successMessage:"moreInfo.inlineEdit.update.success"}}},{name:"alfresco/renderers/Property",config:{propertyToRender:"node.properties.cm:title",renderSize:"small",warnIfNotAvailable:true,warnIfNoteAvailableMessage:"no.title.message",renderFilterMethod:"ALL",renderFilter:[{property:"node.properties.cm:title",values:[""],negate:true},{property:"node.permissions.user.Write",values:[false]}]}},{name:"alfresco/renderers/Version",config:{renderFilterMethod:"ALL",renderFilter:[{property:"node.isContainer",values:[false]},{property:"workingCopy.isWorkingCopy",values:[false],renderOnAbsentProperty:true}]}}]}}]}},{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/Date",config:{deemphasized:true,renderSize:"small"}},{name:"alfresco/renderers/Size",config:{deemphasized:true,renderSize:"small"}}]}}]}},{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{widgets:[{name:"alfresco/renderers/InlineEditProperty",config:{propertyToRender:"node.properties.cm:description",renderSize:"small",postParam:"prop_cm_description",warnIfNotAvailable:true,warnIfNoteAvailableMessage:"no.description.message",publishTopic:"ALF_CRUD_CREATE",publishPayloadType:"PROCESS",publishPayloadModifiers:["processCurrentItemTokens"],publishPayloadItemMixin:false,publishPayload:{url:"api/node/{jsNode.nodeRef.uri}/formprocessor",noRefresh:false},renderFilter:[{property:"node.properties.cm:description",values:[""],negate:true},{property:"node.permissions.user.Write",values:[true]}]}},{name:"alfresco/renderers/Property",config:{propertyToRender:"node.properties.cm:description",renderSize:"small",warnIfNotAvailable:true,warnIfNoteAvailableMessage:"no.description.message",renderFilter:[{property:"node.properties.cm:description",values:[""],negate:true},{property:"node.permissions.user.Write",values:[false]}]}}]}}]}},{name:"alfresco/documentlibrary/views/layouts/Row",config:{widgets:[{name:"alfresco/documentlibrary/views/layouts/Cell",config:{renderFilter:[{property:"workingCopy.isWorkingCopy",values:[false],renderOnAbsentProperty:true}],widgets:[{name:"alfresco/renderers/Favourite"},{name:"alfresco/renderers/Separator"},{name:"alfresco/renderers/Like"},{name:"alfresco/renderers/Separator"},{name:"alfresco/renderers/Comments"},{name:"alfresco/renderers/Separator",config:{renderFilter:[{property:"node.isContainer",values:[false]}]}},{name:"alfresco/renderers/QuickShare",config:{renderFilterMethod:"ALL",renderFilter:[{property:"node.isContainer",values:[false]},{property:"node.permissions.user.Write",values:[true]}]}}]}}]}}]}}]})});