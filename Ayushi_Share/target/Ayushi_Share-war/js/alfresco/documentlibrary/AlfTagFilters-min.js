define(["dojo/_base/declare","alfresco/documentlibrary/AlfDocumentFilters","alfresco/documentlibrary/_AlfDocumentListTopicMixin","alfresco/services/_TagServiceTopics","alfresco/documentlibrary/AlfDocumentFilter","alfresco/core/ObjectTypeUtils","dojo/_base/lang","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/on","dijit/registry"],function(q,b,a,f,l,n,r,h,g,j,k,i){return q([b,a],{i18nRequirements:[{i18nFile:"./i18n/AlfTagFilters.properties"}],filterPrefsName:"docListTagFilterPref",paramName:"tag",siteId:null,containerId:null,rootNode:null,filterSelectionTopic:"ALF_DOCUMENTLIST_TAG_CHANGED",postMixInProperties:function d(){this.inherited(arguments);this.alfSubscribe(this.documentTaggedTopic,r.hitch(this,"onDocumentTagged"));this.alfPublish(f.tagQueryTopic,{callback:this.onTagQueryResults,callbackScope:this,siteId:this.siteId,containerId:this.containerId,rootNode:this.rootNode})},onTagQueryResults:function p(t,s){if(t&&n.isArray(t.tags)){var u=i.findWidgets(this.filtersNode);h.forEach(u,r.hitch(this,"clearTags"));h.forEach(t.tags,r.hitch(this,"createTagFilter"))}else{this.alfLog("warn","A request was made to generate filter tag links, but no 'tags' array attribute was provided",t,s)}},clearTags:function o(t,s){if(typeof t.destroy==="function"){t.destroy()}},createTagFilter:function m(t){if(t&&t.name!=null&&t.count!=null){var s=new l({filterSelectionTopic:this.filterSelectionTopic,label:this.message("filter.tag.label",{"0":t.name,"1":t.count}),filter:t.name,description:this.message("filter.tagged.label",{"0":t.name})});this.addFilter(s)}else{this.alfLog("warn","It is not possible to create a filter tag without 'name' and 'count' attributes",t)}},currentTagFilters:null,onDocumentTagged:function c(s){},compareTags:function e(s,t,u){return t.filterData==s}})});