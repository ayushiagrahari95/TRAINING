define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/HeaderCell.html","alfresco/core/Core","dojo/_base/lang","dojo/dom-class","dojo/query","alfresco/misc/AlfTooltip","dojo/dom-attr"],function(n,a,k,p,g,s,f,c,b,m){return n([a,k,g],{cssRequirements:[{cssFile:"./css/HeaderCell.css"}],templateString:p,sortable:false,usedForSort:false,sortedAscending:false,sortValue:null,toolTipMsg:null,a11yScope:null,sortAscAlt:null,sortDescAlt:null,postMixInProperties:function l(){if(this.label!=null){this.label=this.message(this.label)}this.currentItem={}},postCreate:function h(){this.alfSubscribe("ALF_DOCLIST_SORT",s.hitch(this,this.onExternalSortRequest));this.alfSubscribe("ALF_DOCLIST_SORT_FIELD_SELECTION",s.hitch(this,this.onExternalSortRequest));m.set(this.ascendingSortNode,"alt",this.sortAscAlt?this.sortAscAlt:"");m.set(this.descendingSortNode,"alt",this.sortDescAlt?this.sortDescAlt:"");if(this.sortable===false||this.usedForSort===false){this.sortIcon("nil")}else{this.sortIcon(this.sortedAscending===false?"desc":"asc")}if(this.additionalCssClasses){f.add(this.domNode,this.additionalCssClasses)}if(this.toolTipMsg){this.addToolTipMsg()}if(this.a11yScope){this.addA11yScope(this.a11yScope)}},focus:function d(){this.domNode.focus()},onSortClick:function e(t){if(this.sortable===true){this.alfLog("log","Sort request received");if(this.usedForSort===false){this.usedForSort=true;this.sortedAscending=true;this.sortIcon("asc")}else{if(this.sortedAscending===true){this.sortIcon("desc");this.sortedAscending=false}else{this.sortIcon("asc");this.sortedAscending=true}}this.publishSortRequest()}},publishSortRequest:function q(){this.alfPublish("ALF_DOCLIST_SORT",{direction:(this.sortedAscending)?"ascending":"descending",value:this.sortValue,requester:this})},onExternalSortRequest:function r(w){var t=s.getObject("requester",false,w);if(t!=this){var u=s.getObject("value",false,w);if(u!=null){if(u==this.sortValue){this.usedForSort=true;this.sortIcon(this.sortedAscending===true?"asc":"desc")}else{this.usedForSort=false;this.sortIcon("nil")}}var v=s.getObject("direction",false,w);if(v!=null){this.sortedAscending=(v=="ascending");if(this.usedForSort===true){this.sortIcon(this.sortedAscending===true?"asc":"desc")}}}},sortIcon:function i(t){var w="hidden",v=this.ascendingSortNode,u=this.descendingSortNode;switch(t){case"asc":f.remove(v,w);f.add(u,w);break;case"desc":f.add(v,w);f.remove(u,w);break;default:f.add(v,w);f.add(u,w);break}},addToolTipMsg:function j(){var t=c(".label",this.domNode);var u=new b({targetNode:t,label:this.message(this.toolTipMsg)});this.alfLog("log","Created HeaderCell tooltip with label '"+u.label+"' for item '"+this.domNode+"'",this)},addA11yScope:function o(t){if(t){m.set(this.containerNode,"scope",t)}}})});