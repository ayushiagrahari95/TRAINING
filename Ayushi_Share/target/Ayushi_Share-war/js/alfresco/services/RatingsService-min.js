define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","alfresco/services/_RatingsServiceTopicMixin","dojo/_base/lang","service/constants/Default"],function(g,d,e,b,c,f){return g([d,e,b],{constructor:function i(k){c.mixin(this,k);this.alfSubscribe(this.addRatingTopic,c.hitch(this,this.onAddRating));this.alfSubscribe(this.removeRatingTopic,c.hitch(this,this.onRemoveRating))},getAddRatingsUrl:function j(k){return f.PROXY_URI+"api/node/"+k+"/ratings"},getRemoveRatingsUrl:function j(k){return f.PROXY_URI+"api/node/"+k+"/ratings/likesRatingScheme"},onAddRating:function h(n){var k=(n.alfResponseTopic!=null)?n.alfResponseTopic:this.addRatingTopic;var o=c.getObject("node.jsNode.nodeRef.uri",false,n);if(o){var l=this.getAddRatingsUrl(o);var m={rating:1,ratingScheme:"likesRatingScheme"};this.serviceXhr({url:l,alfTopic:k,data:m,method:"POST"})}},onRemoveRating:function a(m){var k=(m.alfResponseTopic!=null)?m.alfResponseTopic:this.onRemoveRating;var n=c.getObject("node.jsNode.nodeRef.uri",false,m);if(n){var l=this.getRemoveRatingsUrl(n);this.serviceXhr({url:l,alfTopic:k,data:null,method:"DELETE"})}}})});