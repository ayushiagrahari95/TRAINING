define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","dojo/_base/lang","dojo/_base/array","service/constants/Default","alfresco/core/NotificationUtils"],function(g,b,i,a,h,e,d){return g([b,i,d],{constructor:function f(m){a.mixin(this,m);this.alfSubscribe("ALF_GET_FORM_CONTROL_OPTIONS",a.hitch(this,this.onOptionsRequest))},onOptionsRequest:function l(m){if(m.url!=null&&m.itemsAttribute!=null&&m.labelAttribute!=null&&m.valueAttribute!=null&&m.responseTopic!=null){this.serviceXhr({url:m.url,data:m,method:"GET",successCallback:this.optionsSuccess,failureCallback:this.optionsFailure,callbackScope:this})}else{this.alfLog("warn","A request was made to retrieve form control options, but required payload attributes are missing",m,this)}},optionsSuccess:function k(o,m){this.alfLog("log","Successfully retrieved form control options",o,m);var p=[];var n=null;if(m.data.itemsAttribute===""){n=o}else{n=a.getObject(m.data.itemsAttribute,false,o)}if(n!==null){h.forEach(n,a.hitch(this,this.processOptions,p,m.data))}this.alfPublish(m.data.responseTopic,{options:p})},processOptions:function j(p,o,q,n){var m=a.getObject(o.labelAttribute,false,q);var r=a.getObject(o.valueAttribute,false,q);if(m==null&&r==null){this.alfLog("warn","Neither the label or value could be found in the item",q)}else{p.push({label:(m!=null)?m:r,value:r})}},optionsFailure:function c(n,m){this.alfLog("error","Failed to retrieve form control options",n,m);this.displayMessage(this.message("Could not retrieve options",[m.data.name]))}})});