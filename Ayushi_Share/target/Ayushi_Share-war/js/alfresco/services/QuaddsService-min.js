define(["dojo/_base/declare","alfresco/core/Core","alfresco/core/CoreXhr","service/constants/Default","dojo/_base/lang","dojo/_base/array","dojo/json"],function(g,d,e,f,c,k,h){return g([d,e],{constructor:function m(q){c.mixin(this,q);this.alfSubscribe("ALF_GET_ALL_QUADDS",c.hitch(this,"onGetAllQuadds"));this.alfSubscribe("ALF_GET_QUADDS_ITEMS",c.hitch(this,"onGetQuaddsItems"));this.alfSubscribe("ALF_GET_QUADDS_ITEM",c.hitch(this,"onGetQuaddsItem"));this.alfSubscribe("ALF_CREATE_QUADDS_ITEM",c.hitch(this,"onCreateQuaddsItem"));this.alfSubscribe("ALF_UPDATE_QUADDS_ITEM",c.hitch(this,"onUpdateQuaddsItem"));this.alfSubscribe("ALF_DELETE_QUADDS_ITEM",c.hitch(this,"onDeleteQuaddsItem"))},processQuaddItemData:function i(r,q){var s=c.getObject("alfTopic",false,q);if(s!=null){this.alfLog("log","Processing QuADDS data",r,q,this);k.forEach(r.items,function(u,t){try{u.data=h.parse(u.data,true)}catch(v){this.alfLog("warn","Could not process QuADDS data",u.data)}});this.alfPublish(s+"_SUCCESS",r)}else{this.alfLog("error","It was not possible to publish requested QuADDS data because the 'responseTopic' attribute was not set on the original request",r,q)}},refreshRequest:function b(r,q){var s=c.getObject("alfTopic",false,q);if(s!=null){this.alfPublish(s+"_SUCCESS",r)}else{this.alfLog("warn","It was not possible to publish requested QuADDS data because the 'responseTopic' attribute was not set on the original request",r,q)}this.alfPublish("ALF_DISPLAY_NOTIFICATION",{message:"Operation Completed Successfully"});this.alfPublish("ALF_DOCLIST_RELOAD_DATA")},onGetAllQuadds:function l(r){var q=f.PROXY_URI+"aikau/quadds";this.serviceXhr({url:q,method:"GET"})},onGetQuaddsItems:function o(s){var r=c.getObject("quadds",false,s);if(r==null||c.trim(r)===""){this.alfLog("warn","A request was made to retrieve the data items from a QuADDS but no QuADDS was provided",s,this)}else{var q=f.PROXY_URI+"aikau/quadds/"+c.trim(r);this.serviceXhr({url:q,alfTopic:s.alfResponseTopic!=null?s.alfResponseTopic:s.alfTopic,method:"GET",successCallback:this.processQuaddItemData,callbackScope:this})}},onGetQuaddsItem:function p(t){var s=c.getObject("quadds",false,t);var r=c.getObject("name",false,t);if(s==null||s===""){this.alfLog("warn","A request was made to retrieve a data item from a QuADDS but no QuADDS was provided",t,this)}else{if(r==null||c.trim(r)===""){this.alfLog("warn","A request was made to retrieve a data item from a QuADDS but no item name was provided",t,this)}else{var q=f.PROXY_URI+"aikau/quadds/"+c.trim(s)+"/item/"+c.trim(r);this.serviceXhr({url:q,alfTopic:t.alfResponseTopic!=null?t.alfResponseTopic:t.alfTopic,method:"GET",successCallback:this.processQuaddItemData,callbackScope:this})}}},onCreateQuaddsItem:function n(v){var t=c.getObject("quadds",false,v);var s=c.getObject("name",false,v);var u=c.getObject("data",false,v);if(t==null||c.trim(t)===""){this.alfLog("warn","A request was made to create a data item in a QuADDS but no QuADDS was provided",v,this)}else{if(s==null||c.trim(s)===""){this.alfLog("warn","A request was made to create a data item in a QuADDS but no item name was provided",v,this)}else{if(u==null){this.alfLog("warn","A request was made to create a data item in a QuADDS but no data was provided",v,this)}else{var r=f.PROXY_URI+"aikau/quadds/"+c.trim(t);var q={name:s,data:u};this.serviceXhr({url:r,data:q,method:"POST",alfTopic:v.alfResponseTopic!=null?v.alfResponseTopic:v.alfTopic,successCallback:this.refreshRequest,callbackScope:this})}}}},onUpdateQuaddsItem:function j(v){var t=c.getObject("quadds",false,v);var s=c.getObject("name",false,v);var u=c.getObject("data",false,v);if(t==null||c.trim(t)===""){this.alfLog("warn","A request was made to update a data item in a QuADDS but no QuADDS was provided",v,this)}else{if(s==null||c.trim(s)===""){this.alfLog("warn","A request was made to update a data item in a QuADDS but no item name was provided",v,this)}else{if(u==null){this.alfLog("warn","A request was made to update a data item in a QuADDS but no data was provided",v,this)}else{var r=f.PROXY_URI+"aikau/quadds/"+c.trim(t)+"/item/"+c.trim(s);var q={name:s,data:u};this.serviceXhr({url:r,data:q,method:"PUT",alfTopic:v.alfResponseTopic!=null?v.alfResponseTopic:v.alfTopic,successCallback:this.refreshRequest,callbackScope:this})}}}},onDeleteQuaddsItem:function a(t){var s=c.getObject("quadds",false,t);var r=c.getObject("name",false,t);if(s==null||c.trim(s)===""){this.alfLog("warn","A request was made to delete a data item from a QuADDS but no QuADDS was provided",t,this)}else{if(r==null||c.trim(r)===""){this.alfLog("warn","A request was made to delete a data item from a QuADDS but no item name was provided",t,this)}else{var q=f.PROXY_URI+"aikau/quadds/"+c.trim(s)+"/item/"+c.trim(r);this.serviceXhr({url:q,method:"DELETE",alfTopic:t.alfResponseTopic!=null?t.alfResponseTopic:t.alfTopic,successCallback:this.refreshRequest,callbackScope:this})}}}})});