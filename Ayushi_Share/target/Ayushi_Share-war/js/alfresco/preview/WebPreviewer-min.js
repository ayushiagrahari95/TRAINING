define(["dojo/_base/declare","dijit/_WidgetBase","alfresco/core/Core","service/constants/Default","dojo/_base/lang","dojo/on","dojo/dom","dojo/dom-construct","dojo/dom-geometry","dojo/window","dojo/dom-style","dojo/sniff"],function(t,l,a,k,x,j,q,i,s,f,n,v){return t([l,a],{constructor:function h(y){x.mixin(y);this.attributes={src:null,paging:"false",disableI18nInputFix:"false",showFullScreenButton:"true",showFullWindowButton:"true"}},setAttributes:function m(y){var z=x.clone(y);x.mixin(this.attributes,z)},swfDiv:null,fullWindowMode:false,report:function o(){if(!Alfresco.util.hasRequiredFlashPlayer(9,0,124)){return this.previewManager.message("label.noFlash")}},display:function c(){var y=this.resolveUrls();this.createSwfDiv();var z="WebPreviewer_"+this.previewManager.id;var A=new YAHOO.deconcept.SWFObject(k.URL_CONTEXT+"res/components/preview/WebPreviewer.swf",z,"100%","100%","9.0.45");A.addVariable("fileName",this.previewManager.name);A.addVariable("paging",this.attributes.paging);A.addVariable("url",y.url);A.addVariable("i18n_actualSize",this.previewManager.message("preview.actualSize"));A.addVariable("i18n_fitPage",this.previewManager.message("preview.fitPage"));A.addVariable("i18n_fitWidth",this.previewManager.message("preview.fitWidth"));A.addVariable("i18n_fitHeight",this.previewManager.message("preview.fitHeight"));A.addVariable("i18n_fullscreen",this.previewManager.message("preview.fullscreen"));A.addVariable("i18n_fullwindow",this.previewManager.message("preview.fullwindow"));A.addVariable("i18n_fullwindow_escape",this.previewManager.message("preview.fullwindowEscape"));A.addVariable("i18n_page",this.previewManager.message("preview.page"));A.addVariable("i18n_pageOf",this.previewManager.message("preview.pageOf"));A.addVariable("show_fullscreen_button",this.attributes.showFullScreenButton);A.addVariable("show_fullwindow_button",this.attributes.showFullWindowButton);A.addVariable("disable_i18n_input_fix",this.disableI18nInputFix());A.addParam("allowNetworking","all");A.addParam("allowScriptAccess","sameDomain");A.addParam("allowFullScreen","true");A.addParam("wmode","transparent");A.write(this.swfDiv);j(this.swfDiv,"mouseover",x.hitch(this,"onMouseOver",z));j(this.swfDiv,"mouseout",x.hitch(this,"onMouseOut",z));this.synchronizeSwfDivPosition()},onMouseOver:function d(z,y){var A=q.byId(z);if(A&&typeof A.setMode==="function"){A.setMode("active")}},onMouseOut:function p(z,y){var A=q.byId(z);if(A&&typeof A.setMode==="function"){A.setMode("inactive")}},resolveUrls:function e(){return{url:this.attributes.src?this.previewManager.getThumbnailUrl(this.attributes.src):this.previewManager.getContentUrl()}},onWebPreviewerLogging:function w(z,A,y){this.alfLog(A,"WebPreviewer("+y+"): "+z)},onWebPreviewerEvent:function b(A,y){if(A.event){if(A.event.type=="onFullWindowClick"){this.fullWindowMode=true;var B=f.getBox();n.set(this.swfDiv,{left:B.x+"px",top:B.y+"px",width:B.w+"px",height:B.h+"px",zIndex:1000})}else{if(A.event.type=="onFullWindowEscape"){this.fullWindowMode=false;this.synchronizeSwfDivPosition()}}}else{if(A.error){var z="Error";if(A.error.code){z=this.previewManager.message("error."+A.error.code)}Alfresco.util.PopupManager.displayMessage({text:z})}}},disableI18nInputFix:function g(y){return this.attributes.disableI18nInputFix},createSwfDiv:function r(){if(!this.swfDiv){var y=this.previewManager.getPreviewerElement();i.empty(y);var z=i.create("div",{id:this.previewManager.id+"-full-window-div",style:{height:"100%"},className:"web-preview real"},y);this.swfDiv=z}},synchronizeSwfDivPosition:function u(){if(!this.fullWindowMode){var y=this.previewManager.getPreviewerElement();if(y!=null){var z=s.position(y);n.set(this.swfDiv,{left:z.x+"px",top:z.y+"px",width:z.w+"px",height:z.h+"px",zIndex:1000})}}}})});