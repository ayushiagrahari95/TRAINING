define(["dojo/_base/declare","alfresco/renderers/_SearchResultLinkMixin","alfresco/navigation/_HtmlAnchorMixin","service/constants/Default","dojo/_base/lang","dojo/window"],function(e,h,j,c,a,g){return e([h,j],{i18nRequirements:[{i18nFile:"./i18n/SearchThumbnailMixin.properties"}],showDocumentPreview:false,postCreate:function b(){this.inherited(arguments);if(this.publishPayload==null){this.publishPayload={}}this.publishPayload=this.generateSearchLinkPayload(this.publishPayload,this.currentItem,null,this.publishPayloadType,this.publishPayloadItemMixin,this.publishPayloadModifiers);this.makeAnchor(this.publishPayload.url,this.publishPayload.type)},generateSearchLinkPayload:function d(){var m=a.getObject("type",false,this.currentItem),k=a.getObject("mimetype",false,this.currentItem);if(this.showDocumentPreview&&m==="document"){if(k&&k.indexOf("image/")===0){var l=a.getObject("lastThumbnailModification",false,this.currentItem)||1;this.publishTopic="ALF_DISPLAY_LIGHTBOX";return{src:c.PROXY_URI+"api/node/"+a.getObject("nodeRef",false,this.currentItem).replace(":/","")+"/content/thumbnails/imgpreview?c=force&lastModified="+encodeURIComponent(l),title:a.getObject("displayName",false,this.currentItem)}}else{var n=g.getBox();this.publishTopic="ALF_CREATE_DIALOG_REQUEST";return{contentWidth:(n.w*0.7)+"px",contentHeight:(n.h-64)+"px",handleOverflow:false,dialogTitle:this.currentItem.name,additionalCssClasses:"no-padding",widgetsContent:[{name:"alfresco/documentlibrary/AlfDocument",config:{widgets:[{name:"alfresco/preview/AlfDocumentPreview"}]}}],widgetsButtons:[{name:"alfresco/buttons/AlfButton",config:{label:this.message("searchThumbnail.preview.dialog.close"),publishTopic:"NO_OP"}}],publishOnShow:[{publishTopic:"ALF_RETRIEVE_SINGLE_DOCUMENT_REQUEST",publishPayload:{nodeRef:this.currentItem.nodeRef}}]}}}else{return this.inherited(arguments)}},generateFallbackThumbnailUrl:function f(){var k;switch(this.currentItem.type){case"blogpost":k=c.URL_RESCONTEXT+"components/search/images/blog-post.png";break;case"forumpost":k=c.URL_RESCONTEXT+"components/search/images/topic-post.png";break;case"calendarevent":k=c.URL_RESCONTEXT+"components/search/images/calendar-event.png";break;case"wikipage":k=c.URL_RESCONTEXT+"components/search/images/wiki-page.png";break;case"link":k=c.URL_RESCONTEXT+"components/search/images/link.png";break;case"datalist":k=c.URL_RESCONTEXT+"components/search/images/datalist.png";break;case"datalistitem":k=c.URL_RESCONTEXT+"components/search/images/datalistitem.png";break;default:k=c.URL_RESCONTEXT+"components/search/images/generic-result.png";break}return k},getAnchorTargetSelectors:function i(){return["span.inner"]}})});