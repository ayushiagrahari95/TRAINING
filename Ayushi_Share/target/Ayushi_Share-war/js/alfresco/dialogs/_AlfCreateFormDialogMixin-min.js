define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","alfresco/dialogs/AlfDialog","alfresco/forms/Form"],function(h,d,c,j,a){return h([d],{postCreate:function e(){this.inherited(arguments);if(this.dialogConfirmationButtonTitle==null){this.dialogConfirmationButtonTitle=this.message("services.ActionService.button.ok")}if(this.dialogCancellationButtonTitle==null){this.dialogCancellationButtonTitle=this.message("services.ActionService.button.cancel")}this.publishTopic=this.generateUuid();this._formConfirmationTopic=this.generateUuid();this.publishGlobal=true;this.alfSubscribe(this.publishTopic,c.hitch(this,this.onCreateFormDialogRequest),true);this.alfSubscribe(this._formConfirmationTopic,c.hitch(this,this.onDialogConfirmation))},dialog:null,dialogTitle:"",dialogConfirmationButtonTitle:null,dialogCancellationButtonTitle:null,widgets:null,onCreateFormDialogRequest:function i(m){if(this.dialog!=null){this.dialog.destroyRecursive()}if(this.widgets==null){this.alfLog("warn","A request was made to display a dialog but no 'widgets' attribute has been defined",this)}else{try{var n=this.createFormConfig(this.widgets);var k=this.createDialogConfig(n);this.dialog=new j(k);this.dialog.show()}catch(l){this.alfLog("error","The following error occurred creating a dialog for defined configuration",l,this.dialogConfig,this)}}},createDialogConfig:function b(l){var k={title:this.message(this.dialogTitle),pubSubScope:this.pubSubScope,parentPubSubScope:this.parentPubSubScope,widgetsContent:[l],widgetsButtons:[{name:"alfresco/buttons/AlfButton",config:{label:this.dialogConfirmationButtonTitle,disableOnInvalidControls:true,additionalCssClasses:"alfresco-dialogs-_AlfCreateFormDialogMixin confirmation",publishTopic:this._formConfirmationTopic}},{name:"alfresco/buttons/AlfButton",config:{label:this.dialogCancellationButtonTitle,additionalCssClasses:"alfresco-dialogs-_AlfCreateFormDialogMixin cancellation",publishTopic:"ALF_CLOSE_DIALOG"}}]};return k},createFormConfig:function g(k){var l={name:"alfresco/forms/Form",config:{displayButtons:false,widgets:k}};return l},formSubmissionTopic:null,formSubmissionGlobal:true,formSubmissionToParent:false,onDialogConfirmation:function f(l){if(l!=null&&l.dialogContent!=null&&l.dialogContent.length==1&&typeof l.dialogContent[0].getValue==="function"){var k=l.dialogContent[0].getValue();this.alfPublish(this.formSubmissionTopic,k,this.formSubmissionGlobal,this.formSubmissionToParent)}else{this.alfLog("error","The format of the dialog content was not as expected, the 'formSubmissionTopic' will not be published",l,this)}}})});