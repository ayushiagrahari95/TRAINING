define(["dojo/_base/declare","dijit/Dialog","alfresco/core/Core","alfresco/core/CoreWidgetProcessing","alfresco/core/ResizeMixin","dijit/_FocusMixin","dojo/_base/lang","dojo/sniff","dojo/_base/array","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojo/dom-geometry","dojo/html","dojo/aspect","dijit/registry"],function(u,d,l,o,v,h,x,w,f,e,i,p,t,j,n,g){return u([d,l,o,v,h],{cssRequirements:[{cssFile:"./css/AlfDialog.css"}],i18nRequirements:[{i18nFile:"./i18n/AlfDialog.properties"}],textContent:"",widgetsContent:null,widgetsButtons:null,handleOverflow:true,postMixInProperties:function k(){this.inherited(arguments);this.buttonCancel=this.message("button.close")},fixedWidth:false,postCreate:function r(){this.inherited(arguments);this.alfSubscribe("ALF_RESIZE_DIALOG",x.hitch(this,"onResizeRequest"));i.add(this.domNode,"alfresco-dialog-AlfDialog");if(this.additionalCssClasses!=null){i.add(this.domNode,this.additionalCssClasses)}this.bodyNode=e.create("div",{"class":"dialog-body"},this.containerNode,"last");p.set(this.bodyNode,{width:this.contentWidth?this.contentWidth:null,height:this.contentHeight?this.contentHeight:null});if(this.widgetsButtons!=null){this.creatingButtons=true;this.buttonsNode=e.create("div",{"class":"footer"},this.containerNode,"last");this.processWidgets(this.widgetsButtons,this.buttonsNode);this.creatingButtons=false}if(this.widgetsContent!=null){var y=e.create("div",{},this.bodyNode,"last");this.processWidgets(this.widgetsContent,y)}else{if(this.textContent!=null){j.set(this.bodyNode,this.encodeHTML(this.textContent))}}},onShow:function c(){this.inherited(arguments);p.set(document.documentElement,"overflow","hidden")},onHide:function q(){this.inherited(arguments);p.set(document.documentElement,"overflow","")},_onFocus:function a(){this.inherited(arguments);var z=p.getComputedStyle(this.containerNode);var y=t.getMarginBox(this.containerNode,z);if(this.handleOverflow===true){i.add(this.domNode,"handleOverflow")}if(this.fixedWidth===true){p.set(this.domNode,"width",y.w+"px")}this.alfPublishResizeEvent(this.domNode)},onResizeRequest:function s(y){this.alfLog("log","Resizing dialog");if(this.domNode!=null){this.resize()}},allWidgetsProcessed:function b(y){if(this.creatingButtons===true){this._buttons=[];f.forEach(y,x.hitch(this,"attachButtonHandler"))}else{f.forEach(this._buttons,function(A,z){if(A.publishPayload==null){A.publishPayload={}}A.publishPayload.dialogContent=y;A.publishPayload.dialogRef=this})}},_buttons:null,attachButtonHandler:function m(z,y){if(z!=null){this._buttons.push(z);if(w("ie")==8){n.after(z,"onClick",x.hitch(this,this.hide))}else{n.before(z,"onClick",x.hitch(this,this.hide))}}}})});