define(["dojo/_base/declare","dijit/DropDownMenu","alfresco/core/Core","alfresco/core/CoreWidgetProcessing","alfresco/menus/AlfMenuItemWrapper","dojo/_base/array","dojo/dom-class","dojo/_base/event","dojo/on"],function(g,n,e,c,p,k,m,b,j){return g([n,e,c],{cssRequirements:[{cssFile:"./css/AlfDropDownMenu.css"}],postCreate:function i(){this.inherited(arguments);m.add(this.containerNode.parentNode,"alf-dropdown-menu");if(this.widgets){this.processWidgets(this.widgets)}},allWidgetsProcessed:function d(q){var r=this;k.forEach(q,function(t,s){r.addChild(t)})},addChild:function a(s,q){if(s.domNode.tagName.toUpperCase()!="TR"){var r=new p({pubSubScope:s.pubSubScope,item:s});this.inherited(arguments,[r,q])}else{this.inherited(arguments)}this.setFirstAndLastMarkerClasses()},focusNext:function o(){var r=this.getParent();if(m.contains(this.focusedChild.domNode,"last-focusable-entry")){this.alfLog("log","Focus first in next group");var q=r._getSiblingOfChild(this,1);while(q&&typeof q.hasChildren==="function"&&!q.hasChildren()){q=r._getSiblingOfChild(q,1)}if(q&&typeof q.focusFirstChild==="function"){q.focusFirstChild()}else{r._getFirstFocusableChild().focusFirstChild()}}else{this.alfLog("log","Focus next in current group");this.inherited(arguments)}},focusPrev:function l(){var r=this.getParent();if(m.contains(this.focusedChild.domNode,"first-focusable-entry")){this.alfLog("log","Focus last in previous group");var q=r._getSiblingOfChild(this,-1);while(q&&typeof q.hasChildren==="function"&&!q.hasChildren()){q=r._getSiblingOfChild(q,-1)}if(q&&typeof q.focusLastChild==="function"){q.focusLastChild()}else{r._getLastFocusableChild().focusLastChild()}}else{this.alfLog("log","Focus previous in group");this.inherited(arguments)}},removeChild:function h(q){this.inherited(arguments);this.setFirstAndLastMarkerClasses()},setFirstAndLastMarkerClasses:function f(){var t=this.getChildren().length;if(t>0){k.forEach(this.getChildren(),function(v,u){m.remove(v.domNode,"first-focusable-entry");m.remove(v.domNode,"last-focusable-entry")});k.some(this.getChildren(),function(u){if(u.isFocusable()){m.add(u.domNode,"first-focusable-entry");return true}});var r=t-1,s=this.getChildren(),q=false;while(r>=0&&!q){if(s[r].isFocusable()){m.add(s[r].domNode,"last-focusable-entry");q=true}r--}m.add(s[0].domNode,"first-entry");m.add(s[t-1].domNode,"last-entry")}}})});